{"version":3,"sources":["icon.png","components/submissionList.js","components/submissionMap.js","components/forms/uploadForm.js","components/deployments/upload.js","components/deployments/selectCreate.js","utils/safe_storage.js","components/header.js","components/forms/formList.js","components/fetch_data_enhancer.js","components/forms/archivedList.js","App.js","registerServiceWorker.js","store/reducers/auth.js","store/reducers/displayPreferences.js","store/reducers/index.js","store/index.js","index.js","utils/promise.js","store/actions/auth.js","network/formManagement.js","store/actions/displayPreferences.js","network/deployments.js","network/auth.js","network/submissions.js","network/formList.js","components/loginPanel.js"],"names":["module","exports","__webpack_require__","p","jsDateFormatter","formatDate","date","toISOString","split","parseDate","str","Date","placeholder","datePopoverProps","usePortal","SubmissionMenu","props","_this","Object","_home_wille_projetos_HOT_OpenMapKitServer_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_home_wille_projetos_HOT_OpenMapKitServer_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_home_wille_projetos_HOT_OpenMapKitServer_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","archiveForm","event","archiveFormPromise","cancelablePromise","formId","userDetails","username","password","promise","then","r","setState","formArchivedOrDelete","catch","e","console","log","deleteForm","deleteFormPromise","download","urlEnding","filename","downloadName","authBase64","Buffer","toString","fetch","concat","method","headers","X-Requested-With","Authorization","handleErrors","res","blob","objURL","URL","createObjectURL","activeBlob","downloadCsv","toggleDialog","downloadJson","downloadAttachments","downloadFilteredCsv","filterParams","downloadFilteredJson","downloadFilteredAttachments","downloadAllOsm","downloadFilteredOsm","downloadGeojson","downloadFilteredGeojson","downloadFeaturesCsv","downloadFilteredFeaturesCsv","openDialog","state","cancel","role","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_9__","icon","isOpen","onClose","title","className","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_10__","intent","Intent","PRIMARY","text","href","omkMenu","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_12__","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_13__","label","onClick","osmMenu","manageMenu","hasSubmissions","react_router__WEBPACK_IMPORTED_MODULE_7__","to","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_14__","content","position","Position","BOTTOM","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_16__","isAdmin","renderDialog","React","Component","TableItemDownload","_this2","downloadFile","endsWith","react_bootstrap__WEBPACK_IMPORTED_MODULE_19__","src","responsive","SubmissionList","_this3","handleFilterStartDate","startDate","handleFilterEndDate","endDate","handleFilterDeviceIdChange","filterDeviceId","target","value","handleFilterUsernameChange","filterUsername","handlePageChange","loading","page","setTimeout","handlePageSizeChange","pageSize","updatePageSize","updatePagination","filteredSubmissions","handleDataViewChange","option","updateDataView","dataView","filterSubmissions","updateFilterParams","filtered","submissions","filter","item","moment","isBefore","isSame","isAfter","includes","clearFilter","filterStartDate","filterEndDate","getFormDetails","getFormDetailsPromise","formList","formName","xforms","xform","name","totalSubmissions","getAuthStatus","getAuthStatusPromise","authStatus","auth_enabled","authEnabled","findImageValue","entry","image","values","i","map","reduce","n","getSubmissions","getSubmissionsPromise","data","start","end","meta","submissionTime","deviceid","instanceId","length","hasOwnProperty","hasUsername","renderDateCell","format","renderCellImage","line","column","renderCellLink","slicedSubmissions","pageCount","prevProps","prevState","newPageSize","mod","filters","deviceId","start_date","end_date","offset","limit","keys","base","k","slice","devices","undefined","indexOf","react_bootstrap__WEBPACK_IMPORTED_MODULE_20__","react_bootstrap__WEBPACK_IMPORTED_MODULE_21__","xs","md","htmlFor","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_17__","RIGHT","color","_blueprintjs_datetime__WEBPACK_IMPORTED_MODULE_18__","assign","id","onChange","popoverProps","key","_this4","getPageSlice","_this5","Array","apply","Number","isAuthenticated","react_bootstrap__WEBPACK_IMPORTED_MODULE_22__","fluid","renderFilterSection","renderPagination","renderMapSwitchButton","_submissionMap__WEBPACK_IMPORTED_MODULE_28__","renderTable","_loginPanel__WEBPACK_IMPORTED_MODULE_29__","connect","auth","match","params","preferences","dispatch","setDataView","setPageSize","COLOR_STEPS","sortByKey","array","sort","b","x","y","SubmissionMap","_React$Component","info_content","display_map_info","showVizTypeSwitch","vizType","legend","showLegend","_home_wille_projetos_HOT_OpenMapKitServer_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","_home_wille_projetos_HOT_OpenMapKitServer_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","get_color_steps_by_date","get_color_steps_by_user","orderedSubmissionDates","countPerDay","features","feature","properties","submission_date","count","steps","day","push","users","property_key","submission_user","submission_deviceid","setUsers","Set","userCount","user","getSource","layer","removeLayer","removeSource","getSubmissionsGeojson","get_paint_property","addSource","type","addLayer","source","paint","line-color","line-width","fill-color","fill-opacity","fill-outline-color","circle-color","circle-radius","circle-stroke-width","circle-stroke-color","fitBounds","extent","padding","top","bottom","left","right","linear","resize","add_data_to_map","setPaintProperty","mapboxgl","accessToken","Map","container","style","addControl","NavigationControl","on","x1y1","point","x2y2","queryRenderedFeatures","layers","obj","ordered","forEach","orderKeys","getCanvas","cursor","selectedValue","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_11__","UploadForm","success","error","loadingIndicator","errorMessage","uploaderProps","action","multiple","beforeUpload","file","onStart","onSuccess","onProgress","step","Math","round","percent","onError","err","response","msg","_blueprintjs_core__WEBPACK_IMPORTED_MODULE_8__","rc_upload__WEBPACK_IMPORTED_MODULE_7__","ref","iconSize","UploadDeployment","getDeployments","getDeploymentsPromise","deploymentList","files","deployment","bytesToSize","bytes","parseInt","floor","pow","react_bootstrap__WEBPACK_IMPORTED_MODULE_12__","react_bootstrap__WEBPACK_IMPORTED_MODULE_13__","geojson","url","rel","size","mbtiles","osm","rc_upload__WEBPACK_IMPORTED_MODULE_8__","react_router_dom__WEBPACK_IMPORTED_MODULE_7__","SelectCreateDeployment","deployments","selectDeployment","selectedDeployment","unselectDeployment","newFolderNameValue","newDeploymentName","folderNameAlreadyExists","validFolderName","test","createDeploymentFolder","createDeploymentPromise","react_bootstrap__WEBPACK_IMPORTED_MODULE_9__","react_bootstrap__WEBPACK_IMPORTED_MODULE_10__","react_bootstrap__WEBPACK_IMPORTED_MODULE_11__","mdOffset","dir","getItem","localStorage","warn","setItem","removeItem","d","__webpack_exports__","Header","classCallCheck","possibleConstructorReturn","getPrototypeOf","menu","react_default","menu_menu","menuItem","doLogout","popover","buttons","Link","navbar","fixedToTop","navbarGroup","logo","alt","navbarHeading","align","renderAuthSubMenu","logout","FormList","form","card","interactive","elevation","Elevation","TWO","get","buttonGroup","fill","vertical","large","row","Col","renderCol","TypeError","rows","Grid","toConsumableArray","Row","renderRow","dataToFetch","onUpdate","WrappedComponent","_class","_temp","_React$PureComponent","FetchDataEnhancer","_initFetching","fetchedData","set","fromJS","reloadData","initFetching","debounce","inherits","createClass","nextProps","PureComponent","displayName","getDisplayName","withFetchDataSilent","Form","visible","restoreForm","restoreFormPromise","ListGroupItem","ArchivedForms","forms","getArchivedForms","getArchivedFormsPromise","archivedForms","ListGroup","archivedList_Form","App","header_Header","Route","exact","path","component","LoginPanel","isLocalhost","Boolean","window","location","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","initialState","combineReducers","arguments","types","SET_USER","SET_PAGE_SIZE","SET_DATA_VIEW","router","routerReducer","persistedState","safeStorage","history","createHistory","middleware","thunk","routerMiddleware","composedEnhancers","compose","applyMiddleware","store","createStore","reducers","ReactDOM","render","es","Router","src_App_0","document","getElementById","process","origin","addEventListener","status","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","hasCanceled_","Promise","resolve","reject","val","isCanceled","ok","Error","statusText","login","_utils_safe_storage__WEBPACK_IMPORTED_MODULE_0__","CLEAR_USER","Content-Type","body","JSON","stringify","json","updateUserDetails","_utils_promise__WEBPACK_IMPORTED_MODULE_0__","onSubmit","preventDefault","authenticateUser","triedToLogin","bind","_home_wille_projetos_HOT_OpenMapKitServer_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__","changeUsername","changePassword","react__WEBPACK_IMPORTED_MODULE_6___default","react_router__WEBPACK_IMPORTED_MODULE_8__"],"mappings":"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","file":"static/js/main.179866a6.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/icon.f46e375d.png\";","import React from 'react';\nimport { connect } from \"react-redux\";\nimport { Redirect } from 'react-router';\nimport moment from 'moment';\n\nimport {\n  AnchorButton, Button, Popover, Menu, MenuItem, Position, Icon, Dialog, Intent,\n  Tooltip, IPopoverProps\n} from \"@blueprintjs/core\";\nimport { DateInput, IDateFormatProps } from \"@blueprintjs/datetime\";\nimport { Grid, Row, Col, Image } from 'react-bootstrap';\n\nimport { getSubmissions } from '../network/submissions';\nimport { archiveForm, deleteForm } from '../network/formManagement';\nimport { handleErrors } from '../utils/promise';\nimport { formList } from '../network/formList';\nimport { authStatus } from '../network/auth';\nimport { cancelablePromise } from '../utils/promise';\nimport { SubmissionMap } from './submissionMap';\nimport { LoginPanel } from './loginPanel';\nimport { setDataView, setPageSize } from '../store/actions/displayPreferences';\n\n\nconst jsDateFormatter: IDateFormatProps = {\n    // note that the native implementation of Date functions differs between browsers\n    formatDate: date => date.toISOString().split('T')[0],\n    parseDate: str => new Date(str),\n    placeholder: \"YYYY-MM-DD\",\n};\nconst datePopoverProps: IPopoverProps = {\n  usePortal: true\n}\n\nclass SubmissionMenu extends React.Component {\n  archiveFormPromise;\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeBlob: '',\n      downloadName: '',\n      openDialog: false,\n      formArchivedOrDelete: false\n    };\n  }\n\n  componentWillUnmount() {\n      this.archiveFormPromise && this.archiveFormPromise.cancel();\n      this.deleteFormPromise && this.deleteFormPromise.cancel();\n  }\n\n  archiveForm = (event) => {\n    this.archiveFormPromise = cancelablePromise(\n      archiveForm(\n        this.props.formId,\n        this.props.userDetails.username,\n        this.props.userDetails.password\n      )\n    );\n    this.archiveFormPromise.promise.then(\n      r => {\n        this.setState({ formArchivedOrDelete: true });\n      }\n    ).catch(e => console.log(e));\n  }\n\n  deleteForm = (event) => {\n    this.deleteFormPromise = cancelablePromise(\n      deleteForm(\n        this.props.formId,\n        this.props.userDetails.username,\n        this.props.userDetails.password\n      )\n    );\n    this.deleteFormPromise.promise.then(\n      r => {\n        this.setState({ formArchivedOrDelete: true });\n      }\n    ).catch(e => console.log(e));\n  }\n\n  download = (urlEnding, filename) => {\n    this.setState({ downloadName: '' });\n    const authBase64 = new Buffer(\n      this.props.userDetails.username + ':' + this.props.userDetails.password\n    ).toString('base64');\n    return fetch(`/omk/odk/submissions/${urlEnding}`, {\n      method: 'GET',\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest',\n        'Authorization': `Basic ${authBase64}`\n      }\n    })\n      .then(handleErrors)\n      .then(res => res.blob())\n      .then(blob => {\n        const objURL = URL.createObjectURL(blob);\n        this.setState({ activeBlob: objURL });\n        this.setState({\n          downloadName: filename ? filename : urlEnding.split('?')[0]\n        });\n      });\n  }\n\n  isAdmin() {\n    return this.props.userDetails && this.props.userDetails.role === 'admin';\n  }\n  downloadCsv = (event) => {\n    this.download(`${this.props.formId}.csv`);\n    this.toggleDialog();\n  }\n  downloadJson = (event) => {\n    this.download(`${this.props.formId}.json`);\n    this.toggleDialog();\n  }\n  downloadAttachments = (event) => {\n    this.download(`${this.props.formId}.zip`);\n    this.toggleDialog();\n  }\n  downloadFilteredCsv = (event) => {\n    this.download(`${this.props.formId}.csv?${this.props.filterParams}`);\n    this.toggleDialog();\n  }\n  downloadFilteredJson = (event) => {\n    this.download(`${this.props.formId}.json?${this.props.filterParams}`);\n    this.toggleDialog();\n  }\n  downloadFilteredAttachments = (event) => {\n    this.download(`${this.props.formId}.zip?${this.props.filterParams}`);\n    this.toggleDialog();\n  }\n  downloadAllOsm = (event) => {\n    this.download(`${this.props.formId}.osm`);\n    this.toggleDialog();\n  }\n  downloadFilteredOsm = (event) => {\n    this.download(`${this.props.formId}.osm?${this.props.filterParams}`);\n    this.toggleDialog();\n  }\n  downloadGeojson = (event) => {\n    this.download(`${this.props.formId}.geojson`);\n    this.toggleDialog();\n  }\n  downloadFilteredGeojson = (event) => {\n    this.download(`${this.props.formId}.geojson?${this.props.filterParams}`);\n    this.toggleDialog();\n  }\n  downloadFeaturesCsv = (event) => {\n    this.download(`features/${this.props.formId}.csv`);\n    this.toggleDialog();\n  }\n  downloadFilteredFeaturesCsv = (event) => {\n    this.download(`features/${this.props.formId}.csv?${this.props.filterParams}`);\n    this.toggleDialog();\n  }\n\n  toggleDialog = () => this.setState({ openDialog: !this.state.openDialog });\n\n  renderDialog() {\n    return (\n      <Dialog\n        icon=\"cloud-download\"\n        isOpen={this.state.openDialog}\n        onClose={this.toggleDialog}\n        title=\"Download file\"\n      >\n        <div className=\"pt-dialog-body\">\n          {this.state.downloadName\n            ? <div>\n                <p>{this.state.downloadName}</p>\n                <AnchorButton\n                  intent={Intent.PRIMARY}\n                  className=\"pt-small\"\n                  text=\"Download\"\n                  download={this.state.downloadName}\n                  href={this.state.activeBlob}\n                />\n              </div>\n            : <div>Loading data, please wait...</div>\n          }\n\n        </div>\n      </Dialog>\n    );\n  }\n\n  render() {\n    const omkMenu = <Menu>\n      <MenuItem className=\"pt-minimal\" icon=\"th\" label=\"Download CSV\"\n        onClick={this.downloadCsv}\n        />\n      <MenuItem className=\"pt-minimal\" icon=\"code\" label=\"Download JSON\"\n        onClick={this.downloadJson}\n        />\n      <MenuItem className=\"pt-minimal\" icon=\"compressed\" label=\"Download Attachments\"\n        onClick={this.downloadAttachments}\n        />\n      <MenuItem className=\"pt-minimal\" icon=\"th\" label=\"Download Filtered CSV\"\n        onClick={this.downloadFilteredCsv}\n        />\n      <MenuItem className=\"pt-minimal\" icon=\"code\" label=\"Download Filtered JSON\"\n        onClick={this.downloadFilteredJson}\n        />\n      <MenuItem className=\"pt-minimal\" icon=\"compressed\" label=\"Download Filtered Attachments\"\n        onClick={this.downloadFilteredAttachments}\n        />\n    </Menu>;\n    const osmMenu = <Menu>\n        <MenuItem className=\"pt-minimal\" label=\"Data as OSM\"\n          onClick={this.downloadAllOsm}\n          />\n        <MenuItem className=\"pt-minimal\" label=\"Data as GeoJSON\"\n          onClick={this.downloadGeojson}\n          />\n        <MenuItem className=\"pt-minimal\" label=\"Data as CSV\"\n          onClick={this.downloadFeaturesCsv}\n          />\n        {this.props.filterParams && <Menu>\n            <MenuItem className=\"pt-minimal\" label=\"Filtered data as OSM\"\n              onClick={this.downloadFilteredOsm}\n              />\n            <MenuItem className=\"pt-minimal\" label=\"Filtered data as GeoJSON\"\n              onClick={this.downloadFilteredGeojson}\n              />\n            <MenuItem className=\"pt-minimal\" label=\"Filtered data as CSV\"\n              onClick={this.downloadFilteredFeaturesCsv}\n              />\n          </Menu>\n        }\n      </Menu>;\n    const manageMenu = <Menu>\n        <MenuItem className=\"pt-minimal\" icon=\"add-to-folder\" label=\"Archive Form\"\n          onClick={this.archiveForm}\n          />\n        {!this.props.hasSubmissions &&\n          <MenuItem className=\"pt-minimal\" icon=\"trash\" label=\"Delete Form\"\n            onClick={this.deleteForm}\n            />\n        }\n      </Menu>;\n    return (\n      <div>\n        {!this.state.formArchivedOrDelete\n          ? <div>\n              <Popover content={omkMenu} position={Position.BOTTOM} className=\"pt-intent-default\">\n                <Button icon=\"link\">ODK Data <Icon icon=\"caret-down\" /></Button>\n              </Popover>\n              <Popover content={osmMenu} position={Position.BOTTOM} className=\"pt-intent-default\">\n                <Button icon=\"path-search\">OSM Data <Icon icon=\"caret-down\" /></Button>\n              </Popover>\n              {this.isAdmin() &&\n                <Popover content={manageMenu} position={Position.BOTTOM}\n                  className=\"pt-intent-default\"\n                >\n                  <Button icon=\"cog\">Manage <Icon icon=\"caret-down\" /></Button>\n                </Popover>\n              }\n              {this.renderDialog()}\n            </div>\n          : <Redirect to='/' />\n        }\n      </div>\n    );\n  }\n};\n\n\nclass TableItemDownload extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeBlob: '',\n      isOpen: false\n    }\n  }\n\n  download = (urlEnding, filename) => {\n    this.setState({ downloadName: '' });\n    const authBase64 = new Buffer(\n      this.props.userDetails.username + ':' + this.props.userDetails.password\n    ).toString('base64');\n    return fetch(`/omk/data/submissions/${urlEnding}`, {\n      method: 'GET',\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest',\n        'Authorization': `Basic ${authBase64}`\n      }\n    })\n      .then(handleErrors)\n      .then(res => res.blob())\n      .then(blob => {\n        const objURL = URL.createObjectURL(blob);\n        this.setState({ activeBlob: objURL });\n        this.setState({\n          downloadName: filename ? filename : urlEnding.split('?')[0]\n        });\n      });\n  }\n\n  downloadFile = (event) => {\n    this.download(this.props.urlEnding, this.props.filename);\n    this.toggleDialog();\n  }\n\n  toggleDialog = () => this.setState({ isOpen: !this.state.isOpen });\n\n  renderDialog() {\n    return (\n      <Dialog\n        icon=\"cloud-download\"\n        isOpen={this.state.isOpen}\n        onClose={this.toggleDialog}\n        title=\"Download file\"\n      >\n        <div className=\"pt-dialog-body\">\n          {this.state.downloadName\n            ? <div>\n                {(this.props.filename.endsWith('.jpg') || this.props.filename.endsWith('.png'))\n                  ? <Image src={this.state.activeBlob} responsive className=\"preview-submission-img\" />\n                  : <p>{this.props.filename}</p>\n                }\n                <AnchorButton\n                  intent={Intent.PRIMARY}\n                  className=\"pt-small\"\n                  text=\"Download\"\n                  download={this.props.filename}\n                  href={this.state.activeBlob}\n                />\n              </div>\n            : <div>Loading data, please wait...</div>\n          }\n        </div>\n      </Dialog>\n    );\n  }\n\n  render() {\n    if (this.props.filename) {\n      if (this.props.filename.endsWith('.osm')) {\n        return(\n          <div>\n            <a onClick={this.downloadFile}>OSM File</a>\n            {this.renderDialog()}\n          </div>\n        );\n      } else {\n        return(\n          <div>\n            <a onClick={this.downloadFile}>Download image</a>\n            {this.renderDialog()}\n          </div>\n        );\n      }\n    } else {\n      return(\n        <span>No data</span>\n      );\n    }\n  }\n}\n\n\nclass SubmissionList extends React.Component {\n  getSubmissionsPromise;\n  getFormDetailsPromise;\n  getAuthStatusPromise;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      submissions: [],\n      filteredSubmissions: [],\n      slicedSubmissions: [],\n      loading: true,\n      formName: '',\n      totalSubmissions: 0,\n      startDate: null,\n      endDate: null,\n      filterDeviceId: '',\n      filterUsername: '',\n      filterParams: 'offset=0&limit=200',\n      hasUsername: false,\n      dataView: props.dataView || 'map',\n      page: 1,\n      pageSize: props.pageSize || 200,\n      pageCount: 1,\n      authEnabled: true\n    }\n  }\n\n  componentWillUnmount() {\n    this.getSubmissionsPromise && this.getSubmissionsPromise.cancel();\n    this.getFormDetailsPromise && this.getFormDetailsPromise.cancel();\n    this.getAuthStatusPromise && this.getAuthStatusPromise.cancel();\n  }\n\n  componentDidMount() {\n    this.getSubmissions();\n    this.getFormDetails();\n    if (!(this.props.userDetails && this.props.userDetails.username != null)) {\n      this.getAuthStatus();\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.userDetails.username !== prevProps.userDetails.username) {\n      this.getSubmissions();\n    }\n    if (prevState.page !== this.state.page || prevState.pageSize !== this.state.pageSize) {\n      this.updateFilterParams();\n    }\n  }\n\n  updatePagination(newPageSize, filtered) {\n    if (filtered.length > newPageSize) {\n      const mod = filtered.length % newPageSize;\n      this.setState({'pageCount': ((filtered.length - mod) / newPageSize) + 1});\n    } else {\n      this.setState({'pageCount': 1});\n    }\n  }\n\n  handleFilterStartDate = (date) => {\n    if (date) {\n      this.setState({ startDate: date.toISOString().split('T')[0]});\n    } else {\n      this.setState({ startDate: null });\n    }\n  }\n\n  handleFilterEndDate = (date) => {\n    if (date) {\n      this.setState({ endDate: date.toISOString().split('T')[0]});\n    } else {\n      this.setState({ endDate: null });\n    }\n  }\n\n  handleFilterDeviceIdChange = (event) => {\n    this.setState({ filterDeviceId: event.target.value });\n  }\n\n  handleFilterUsernameChange = (event) => {\n    this.setState({ filterUsername: event.target.value });\n  }\n\n  handlePageChange = (event) => {\n    this.setState({ loading: true });\n    this.setState({ page: event.target.value });\n    setTimeout(() => {\n      this.setState({ loading: false });\n    }, 10);\n  }\n\n  handlePageSizeChange = (event) => {\n    this.setState({ loading: true, page: 1 });\n    this.setState({ pageSize: event.target.value });\n    this.props.updatePageSize(event.target.value);\n    this.updatePagination(event.target.value, this.state.filteredSubmissions);\n    setTimeout(() => {\n      this.setState({ loading: false });\n    }, 10);\n  }\n\n  handleDataViewChange = (option) => {\n    this.props.updateDataView(option);\n    this.setState({ dataView: option });\n  }\n\n  updateFilterParams() {\n    const filters = {\n      deviceId: this.state.filterDeviceId,\n      start_date: this.state.startDate,\n      end_date: this.state.endDate,\n      username: this.state.filterUsername,\n      offset: (this.state.page - 1) * this.state.pageSize || 0,\n      limit: this.state.pageSize || 200\n    };\n    const filterParams = Object.keys(filters).filter(\n      i => filters[i]\n    ).reduce(\n      (base, k) => `${base}${k}=${filters[k]}&`,\n    '');\n    this.setState({'filterParams': filterParams});\n  }\n\n  filterSubmissions = () => {\n    this.setState({ loading: true });\n    this.updateFilterParams();\n    this.setState({ page: 1 });\n    let filtered = this.state.submissions;\n    if (this.state.startDate) {\n      filtered = filtered.filter(\n        item =>\n          moment(this.state.startDate).isBefore(item[3], 'day') ||\n          moment(this.state.startDate).isSame(item[3], 'day')\n      );\n    }\n    if (this.state.endDate) {\n      filtered = filtered.filter(\n        item =>\n          moment(this.state.endDate).isAfter(item[3], 'day') ||\n          moment(this.state.endDate).isSame(item[3], 'day')\n      );\n    }\n    if (this.state.filterDeviceId) {\n      filtered = filtered.filter(\n        item => item[2] && item[2].toString().includes(this.state.filterDeviceId)\n      );\n    }\n    if (this.state.filterUsername) {\n      filtered = filtered.filter(\n        item => item[2] && item[2].toString().includes(this.state.filterUsername)\n      );\n    }\n    this.setState({ filteredSubmissions: filtered });\n    this.updatePagination(this.state.pageSize, filtered);\n    this.setState({ loading: false });\n  }\n\n  clearFilter = () => {\n    this.setState({ loading: true });\n    this.setState({ filteredSubmissions: this.state.submissions });\n    this.setState({ filterStartDate: null });\n    this.setState({ filterEndDate: null });\n    this.setState({ filterDeviceId: '' });\n    this.setState({ filterUsername: '' });\n    this.updatePagination(this.state.pageSize, this.state.submissions);\n    this.setState({ loading: false });\n    this.setState({\n      filterParams: `offset=${(this.state.page - 1) * this.state.pageSize || 0}&limit=${this.state.pageSize}`\n    });\n  }\n\n  getFormDetails = () => {\n    this.getFormDetailsPromise = cancelablePromise(\n      formList(this.props.formId)\n    );\n    this.getFormDetailsPromise.promise.then(\n      r => {\n        this.setState({ formName: r.xforms.xform[0].name });\n        this.setState({ totalSubmissions: r.xforms.xform[0].totalSubmissions });\n      }\n    ).catch(e => console.log(e));\n  }\n\n  getPageSlice() {\n    return this.state.filteredSubmissions.slice(\n      (this.state.page - 1) * this.state.pageSize,\n      this.state.page * this.state.pageSize\n    );\n  }\n  getAuthStatus = () => {\n    this.getAuthStatusPromise = cancelablePromise(\n      authStatus()\n    );\n    this.getAuthStatusPromise.promise.then(\n      r => {\n        console.log('response ' + r.auth_enabled);\n        this.setState({ authEnabled: r.auth_enabled });\n      }\n    ).catch(e => console.log(e));\n  }\n  findImageValue = (entry) => {\n    if (entry.image) return entry.image;\n    // try to find an image in the first level string values\n    var image = Object.values(entry).filter(\n      i => typeof(i) === 'string'\n    ).filter(\n      i => i.endsWith('.jpg') || i.endsWith('.jpeg') || i.endsWith('.png')\n    )[0];\n    if (image) {\n      return image;\n    } else {\n      // try to find an image value inside an object\n      return Object.values(entry).filter(\n        i => typeof(i) === 'object'\n      ).map(\n        i => Object.values(i)\n      ).reduce(\n        (i, n) => n.concat(i), []\n      ).filter(\n        i => typeof(i) === 'string'\n      ).filter(\n        i => i.endsWith('.jpg') || i.endsWith('.jpeg') || i.endsWith('.png')\n      )[0];\n    }\n  }\n  getSubmissions = () => {\n    this.getSubmissionsPromise = cancelablePromise(\n      getSubmissions(\n        this.props.formId,\n        this.props.userDetails.username,\n        this.props.userDetails.password\n      )\n    );\n\n    this.getSubmissionsPromise.promise.then(\n      r => {\n        let data = r.map(i => [\n          i.start,\n          i.end ? i.end : i.meta.submissionTime,\n          i.username ? i.username : i.deviceid,\n          i.meta.submissionTime,\n          this.findImageValue(i),\n          Object.values(i).filter(\n            entry => typeof(entry) === 'string' && entry.endsWith('.osm')\n          )[0],\n          i.meta.instanceId.split(':')[1],\n        ]);\n        if (r.length > 0 && r[0].hasOwnProperty('username')) {\n          this.setState({ hasUsername: true });\n        }\n        this.updatePagination(this.state.pageSize, data);\n        this.setState({\n          submissions: data,\n          filteredSubmissions: data,\n          loading: false\n        });\n      }\n    ).catch(e => {\n      console.log(e);\n      this.setState({ loading: false });\n    });\n  }\n\n  renderDateCell = (data) => moment(data).format('lll');\n\n  renderCellImage = (line, column) => line[column]\n    ? <TableItemDownload\n        urlEnding={`${this.props.formId}/${line[column+2]}/${line[column]}`}\n        filename={line[column]}\n        userDetails={this.props.userDetails}\n      />\n    : <span>No image</span>\n  ;\n\n  renderCellLink = (line, column) => <TableItemDownload\n      urlEnding={`${this.props.formId}/${line[column+1]}/${line[column]}`}\n      filename={line[column]}\n      userDetails={this.props.userDetails}\n  />;\n\n  renderFilterSection() {\n    let devices = this.state.submissions.map(item => item[2]);\n    devices = devices.filter(i => i !== undefined).filter((i, k) => devices.indexOf(i) === k);\n    return(\n      <Row className=\"filters ml-0 mr-0\">\n        <Row className=\"ml-0 mr-0\">\n          <Col xs={12} md={6} className=\"pt-input-group\">\n            <label htmlFor=\"start-date\" className=\"display-block\">\n              From\n              <Tooltip content=\"Based on the Submission Date\" position={Position.RIGHT}>\n                <Icon icon=\"help\" color=\"#CED9E0\" className=\"help-icon\"/>\n              </Tooltip>\n            </label>\n            <DateInput {...jsDateFormatter}\n              id=\"start-date\"\n              onChange={this.handleFilterStartDate}\n              popoverProps={datePopoverProps}\n              />\n          </Col>\n          <Col xs={12} md={6} className=\"pt-input-group\">\n            <label htmlFor=\"end-date\" className=\"display-block\">\n              To\n              <Tooltip content=\"Based on the Submission Date\" position={Position.RIGHT}>\n                <Icon icon=\"help\" color=\"#CED9E0\" className=\"help-icon\"/>\n              </Tooltip>\n            </label>\n            <DateInput {...jsDateFormatter}\n              id=\"end-date\"\n              onChange={this.handleFilterEndDate}\n              popoverProps={datePopoverProps}\n              />\n          </Col>\n        </Row>\n        <Row className=\"ml-0 mr-0\">\n          {this.state.hasUsername\n            ? <Col xs={12} className=\"pt-input-group\">\n                <label htmlFor=\"filter-username\" className=\"display-block\">\n                  Username\n                </label>\n                <div className=\"pt-select\">\n                  <select onChange={this.handleFilterUsernameChange} value={this.state.filterUsername}>\n                    <option value={null} >Choose an item...</option>\n                    {devices.map(\n                      (item, k) =>\n                      <option key={k} value={ `${item}` }>\n                        { item.toString() }\n                      </option>\n                    )}\n                  </select>\n                </div>\n              </Col>\n            : <Col xs={12} className=\"pt-input-group\">\n                <label htmlFor=\"filter-deviceid\" className=\"display-block\">\n                  Device ID\n                </label>\n                <div className=\"pt-select\">\n                  <select onChange={this.handleFilterDeviceIdChange} value={this.state.filterDeviceId}>\n                    <option value={null} >Choose an item...</option>\n                    {devices.map(\n                      (item, k) =>\n                      <option key={k} value={ `${item}` }>\n                        { item.toString() }\n                      </option>\n                    )}\n                  </select>\n                </div>\n              </Col>\n            }\n        </Row>\n        <Row className=\"ml-0 mr-0\">\n          <Col xs={12} md={6} className=\"pt-input-group\">\n            <Button className=\"pt-intent-success filter-btn\"\n              icon=\"filter\" text=\"Filter\" onClick={this.filterSubmissions}\n              />\n          </Col>\n          <Col xs={12} md={6} className=\"pt-input-group\">\n            <Button className=\"pt-intent-danger filter-btn\"\n              icon=\"filter-remove\" text=\"Clear\" onClick={this.clearFilter}\n              />\n          </Col>\n        </Row>\n      </Row>\n    );\n  }\n\n  renderTable() {\n    if (this.state.loading) {\n      return(<div id=\"loading-msg\">Loading data, please wait...</div>);\n    } else {\n      if (this.state.filteredSubmissions.length === 0) {\n        return(<div id=\"loading-msg\">No data was found.</div>);\n      } else {\n        return (\n          <table className=\"pt-html-table pt-html-table-bordered pt-interactive mb-20 mt-10\">\n            <thead>\n              <tr>\n                <th>Start</th>\n                <th>End</th>\n                {this.state.hasUsername\n                  ? <th>Username</th>\n                  : <th>Device ID</th>\n                }\n                <th>Submission Time</th>\n                <th>Image</th>\n                <th>Download</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.getPageSlice().map((line, k) =>\n                  <tr key={k}>\n                    <td>{this.renderDateCell(line[0])}</td>\n                    <td>{this.renderDateCell(line[1])}</td>\n                    <td>{line[2]}</td>\n                    <td>{this.renderDateCell(line[3])}</td>\n                    <td>{this.renderCellImage(line, 4)}</td>\n                    <td>{this.renderCellLink(line, 5)}</td>\n                  </tr>\n                )\n              }\n            </tbody>\n          </table>\n        );\n      }\n    }\n  }\n\n  renderMapSwitchButton() {\n    return(\n      <Row className=\"ml-0 mr-0\">\n        <Col xs={12}>\n          {this.state.dataView === 'map'\n            ? <Button className=\"pt-intent\" icon=\"th\" text=\"Switch to Table view\"\n                onClick={() => this.handleDataViewChange('table')}\n                />\n            : <Button className=\"pt-intent\" icon=\"map\" text=\"Switch to Map view\"\n                onClick={() => this.handleDataViewChange('map')}\n                />\n          }\n        </Col>\n      </Row>\n    );\n  }\n\n  renderPagination() {\n    return(\n      <Row className=\"pagination pt-input-group ml-0 mr-0\">\n        <Col xs={12} md={6} className=\"pt-input-group\">\n          <label className=\"display-block\">Page Size</label>\n          <div className=\"pt-select\">\n            <select onChange={this.handlePageSizeChange} value={this.state.pageSize}>\n                {[5000, 1000, 800, 600, 400, 200, 100, 50, 20].map(\n                  (item, k) =>\n                  <option key={k} value={ item }>\n                    { item.toString() }\n                  </option>\n                )}\n              </select>\n          </div>\n        </Col>\n        <Col xs={12} md={6} className=\"pt-input-group\">\n          <label className=\"display-block\">Page</label>\n          <div className=\"pt-select\">\n            <select onChange={this.handlePageChange}>\n              {Array.apply(null, { length: this.state.pageCount }).map(\n                Number.call, Number\n              ).map(\n                i => i + 1\n              ).map(\n                (item, k) =>\n                <option key={k} value={ item }>\n                  { item.toString() }\n                </option>\n              )}\n            </select>\n          </div>\n        </Col>\n      </Row>\n    );\n  }\n\n  render() {\n    const isAuthenticated = (this.props.userDetails &&\n        this.props.userDetails.username != null) || !this.state.authEnabled;\n\n    return(\n      <div>\n        {isAuthenticated\n          ? <Grid fluid={true} className=\"pl-0 pr-0\">\n              <Row className=\"ml-0 mr-0\">\n                <Col xs={12} md={3} className=\"sticky\">\n                  <div className=\"submissions-info\">\n                    <h4 className=\"break-all\">{ this.state.formName }</h4>\n                    <p>Total submissions: { this.state.totalSubmissions }</p>\n                    <SubmissionMenu\n                      formId={this.props.formId}\n                      hasSubmissions={this.state.totalSubmissions > 0}\n                      filterParams={this.state.filterParams}\n                      userDetails={this.props.userDetails}\n                    />\n                  </div>\n                  { this.renderFilterSection() }\n                  { this.renderPagination() }\n                  { this.renderMapSwitchButton() }\n                </Col>\n                <Col xs={12} md={9} className=\"ml-0 mr-0 pr-0\">\n                  {this.state.dataView === 'map'\n                    ? <SubmissionMap\n                        userDetails={this.props.userDetails}\n                        formId={this.props.formId}\n                        filterParams={this.state.filterParams}\n                        hasUsername={this.state.hasUsername}\n                      />\n                    : this.renderTable()\n                  }\n                </Col>\n              </Row>\n            </Grid>\n          : <LoginPanel />\n        }\n      </div>\n    );\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    updateDataView: (option) => dispatch(setDataView(option)),\n    updatePageSize: (option) => dispatch(setPageSize(option))\n  };\n};\n\n\nSubmissionList = connect(\n  (state, props) => ({\n    userDetails: state.auth.userDetails,\n    formId: props.match.params.formId,\n    dataView: state.preferences.dataView,\n    pageSize: state.preferences.pageSize\n  }),\n  mapDispatchToProps\n)(SubmissionList)\n\nexport {SubmissionList};\n","import React from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport { Set } from 'immutable';\nimport { extent } from 'geojson-bounds';\nimport { array as countPerDay } from 'count-per-day';\nimport { RadioGroup, Radio, Icon } from \"@blueprintjs/core\";\n\nimport { getSubmissionsGeojson } from '../network/submissions';\n\nconst COLOR_STEPS = [\n  \"#29A634\", \"#1F4B99\", \"#D99E0B\", \"#D13913\", \"#8F398F\", \"#00B3A4\", \"#728C23\",\n  \"#DB2C6F\", \"#B07B46\", \"#7157D9\", \"#B6D94C\", \"#63411E\"\n];\nconst OTHER_COLOR = '#4580E6';\n\nfunction orderKeys(obj) {\n  const ordered = {};\n  Object.keys(obj).sort().forEach(function(key) {\n    ordered[key] = obj[key];\n  });\n  return ordered;\n}\n\nfunction sortByKey(array, key) {\n    return array.sort(function(a, b) {\n        var x = a[key]; var y = b[key];\n        return ((x > y) ? -1 : ((x < y) ? 1 : 0));\n    });\n}\n\nexport class SubmissionMap extends React.Component {\n  constructor(props) {\n    super(props);\n    this.map = null\n    this.state = {\n      info_content: '',\n      display_map_info: 'none',\n      data: {},\n      showVizTypeSwitch: false,\n      vizType: 'default',\n      legend: [],\n      showLegend: true\n    };\n  }\n\n  get_paint_property(data) {\n    if (this.state.vizType === 'default') {\n      return OTHER_COLOR;\n    }\n    if (this.state.vizType === 'date') {\n      return this.get_color_steps_by_date(data);\n    }\n    if (this.state.vizType === 'user') {\n      return this.get_color_steps_by_user(data);\n    }\n  }\n\n  get_color_steps_by_date(data) {\n    // set colour features colours\n    let legend = [];\n    const submissionDates = countPerDay(data.features.map(\n      feature => new Date(feature.properties.submission_date)\n    )).filter(item => item.count);\n    const orderedSubmissionDates = sortByKey(submissionDates, 'count');\n    let steps = ['match', ['get', 'submission_date']];\n    orderedSubmissionDates.slice(0, 12)\n      .map((date, n) => {\n        steps = steps.concat([date.day, COLOR_STEPS[n]]);\n        legend.push([date.day, COLOR_STEPS[n]]);\n      }\n    );\n    steps.push(OTHER_COLOR);\n    legend.push(['Others', OTHER_COLOR]);\n    this.setState({'legend': legend});\n    return steps;\n  }\n\n  get_color_steps_by_user(data) {\n    var users, property_key;\n    let legend = [];\n    if (this.props.hasUsername) {\n      users = data.features.map(\n        feature => feature.properties.submission_user\n      );\n      property_key = 'submission_user';\n    } else {\n      users = data.features.map(\n        feature => feature.properties.submission_deviceid\n      );\n      property_key = 'submission_deviceid';\n    }\n    const setUsers = new Set(users);\n    var userCount = [];\n    setUsers.map(user => userCount.push(\n      {'user': user, 'count': users.filter(i => i === user).length}\n    ));\n    userCount = sortByKey(userCount, 'count');\n    let steps = ['match', ['get', property_key]];\n    userCount.slice(0, 12)\n      .map((user, n) => {\n        steps = steps.concat([user.user, COLOR_STEPS[n]]);\n        legend.push([user.user, COLOR_STEPS[n]]);\n      });\n    steps.push(OTHER_COLOR);\n    legend.push(['Others', OTHER_COLOR])\n    this.setState({'legend': legend});\n    return steps;\n  }\n\n  add_data_to_map() {\n    if (this.map.getSource('submissions')) {\n      ['submission_areas', 'submission_lines', 'submission_points'].map(\n        layer => this.map.removeLayer(layer)\n      );\n      this.map.removeSource('submissions');\n    }\n    getSubmissionsGeojson(\n      this.props.formId,\n      this.props.userDetails.username,\n      this.props.userDetails.password,\n      this.props.filterParams\n    ).then(data => {\n      this.setState({'showVizTypeSwitch': true});\n      // exclude nodes that doesn't have OSM tags\n      data['features'] = data.features.filter(i => Object.keys(i.properties).length > 7);\n      this.setState({'data': data});\n      const steps = this.get_paint_property(data);\n\n      this.map.addSource('submissions', {\n        \"type\": \"geojson\",\n        \"data\": data\n      });\n      this.map.addLayer({\n        \"id\": \"submission_lines\",\n        \"type\": \"line\",\n        \"source\": \"submissions\",\n        \"filter\": [\"==\", \"$type\", \"LineString\"],\n        \"paint\": {\n          \"line-color\": steps,\n          \"line-width\": 3\n        }\n      });\n      this.map.addLayer({\n        \"id\": \"submission_areas\",\n        \"type\": \"fill\",\n        \"source\": \"submissions\",\n        \"filter\": [\"in\", \"$type\", \"Polygon\"],\n        \"paint\": {\n          \"fill-color\": steps,\n          \"fill-opacity\": 0.4,\n          \"fill-outline-color\": \"#61FC03\"\n        }\n      });\n      this.map.addLayer({\n        \"id\": \"submission_points\",\n        \"type\": \"circle\",\n        \"source\": \"submissions\",\n        \"filter\": [\"==\", \"$type\", \"Point\"],\n        \"paint\": {\n          \"circle-color\": steps,\n          \"circle-radius\": 4,\n          \"circle-stroke-width\": 1,\n          \"circle-stroke-color\": \"#fff\"\n        }\n      });\n      this.map.fitBounds(\n        extent(data),\n        {\"padding\": {top: 80, bottom: 35, left: 35, right: 35}, \"linear\": true}\n      );\n    });\n    this.map.resize();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.filterParams !== prevProps.filterParams) {\n      this.add_data_to_map();\n    }\n    if (this.state.vizType !== prevState.vizType) {\n      const steps = this.get_paint_property(this.state.data);\n      this.map.setPaintProperty(\n        'submission_lines', 'line-color', steps\n      );\n      this.map.setPaintProperty(\n        'submission_areas', 'fill-color', steps\n      );\n      this.map.setPaintProperty(\n        'submission_points', 'circle-color', steps\n      );\n    }\n  }\n\n  componentDidMount() {\n    mapboxgl.accessToken = 'pk.eyJ1IjoiaG90IiwiYSI6IlBtUmNiR1kifQ.dCS1Eu9DIRNZGktc24IwtA';\n    this.map = new mapboxgl.Map({\n      container: 'map',\n        style: 'mapbox://styles/mapbox/satellite-v9',\n    });\n    this.map.addControl(new mapboxgl.NavigationControl(), \"top-right\");\n    this.map.on('load', () => {\n      this.add_data_to_map();\n    });\n    this.map.on('click', e => {\n      var x1y1 = [e.point.x - 5, e.point.y - 5];\n      var x2y2 = [e.point.x + 5, e.point.y + 5];\n      var features = this.map.queryRenderedFeatures([x1y1, x2y2], {\n        layers: ['submission_areas', 'submission_lines', 'submission_points']\n      });\n      if (features.length) {\n        const properties = orderKeys(features[0].properties);\n        const keys = Object.keys(properties);\n        const values = Object.values(properties);\n        this.setState({\n          info_content: keys.map((key, n) =>\n            <tr key={n}>\n              <td className=\"feature-key\">{key}</td>\n              <td className=\"feature-value\">{values[n]}</td>\n            </tr>\n          )\n        });\n        this.setState({\n          display_map_info: 'block'\n        });\n      } else {\n        this.setState({\n          display_map_info: 'none',\n          info_content: ''\n        });\n      }\n    });\n    ['submission_areas', 'submission_lines', 'submission_points'].forEach(\n      layer => {\n          this.map.on('mouseenter', layer, () => {\n          this.map.getCanvas().style.cursor = 'pointer';\n        });\n\n        // Change it back to a pointer when it leaves.\n        this.map.on('mouseleave', layer, () => {\n          this.map.getCanvas().style.cursor = '';\n        });\n      }\n    );\n  }\n\n  render() {\n    return(\n      <div>\n        <div id=\"map\">\n          {this.state.info_content &&\n            <div className={'map-info display-block'}>\n              <table><tbody>{this.state.info_content}</tbody></table>\n            </div>\n          }\n          {this.state.showVizTypeSwitch &&\n            <div className=\"color-switch\">\n              <RadioGroup\n                label=\"Features colouring\"\n                onChange={e => this.setState({ vizType: e.target.value })}\n                selectedValue={this.state.vizType}\n                >\n                <Radio label=\"Default Color\" value=\"default\" />\n                <Radio label=\"By Submission Date\" value=\"date\" />\n                <Radio label={`By ${this.props.hasUsername ? 'User' : 'Device ID'}`} value=\"user\" />\n              </RadioGroup>\n              {this.state.vizType !== 'default' &&\n                <div>\n                  <label id=\"legend-label\" className=\"pt-label\" onClick={e => this.setState({ showLegend: !this.state.showLegend })}>\n                    {this.state.showLegend\n                      ? <Icon icon=\"chevron-down\" />\n                      : <Icon icon=\"chevron-right\" />\n                    }\n                    Legend\n                  </label>\n                  {this.state.showLegend && this.state.legend.map(\n                    (item, n) => <div key={n}>\n                        <Icon icon=\"full-circle\" color={`${item[1]}`} /> <span>{item[0]}</span>\n                      </div>\n                  )}\n                </div>\n              }\n            </div>\n          }\n      </div>\n    </div>\n  );\n  }\n}\n","import React from 'react';\nimport {connect} from \"react-redux\";\nimport Upload from 'rc-upload';\n\nimport { Callout, Icon } from '@blueprintjs/core';\n\n\nclass UploadForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      success: false,\n      error: false,\n      loadingIndicator: false,\n      errorMessage: ''\n    }\n    this.authBase64 = null;\n    if (this.props.userDetails && this.props.userDetails.hasOwnProperty('username') && this.props.userDetails.username !== null) {\n      this.authBase64 = new Buffer(\n        `${this.props.userDetails.username}:${this.props.userDetails.password}`\n      ).toString('base64');\n    }\n  }\n\n  render() {\n    const uploaderProps = {\n      action: '/omk/odk/upload-form',\n      headers: {\n        Authorization: `Basic ${this.authBase64}`\n      },\n      multiple: true,\n      beforeUpload(file) {\n        console.log('beforeUpload', file.name);\n      },\n      onStart: (file) => {\n        this.setState({loadingIndicator: true, error: false, success: false});\n        console.log('onStart', file.name);\n      },\n      onSuccess: (file) => {\n        this.setState({loadingIndicator: false, error: false, success: true});\n        console.log('onSuccess', file);\n      },\n      onProgress(step, file) {\n        console.log('onProgress', Math.round(step.percent), file.name);\n      },\n      onError: (err, response) => {\n        this.setState({\n          loadingIndicator: false,\n          error: true,\n          success: false,\n          errorMessage: response.msg\n        });\n      }\n    };\n    return (<div className=\"container\">\n      {\n        this.state.success && <Callout title=\"Success!\" intent=\"success\" className=\"upload-result\">\n            Your file(s) has been successfully uploaded and the new forms are already available\n          </Callout>\n      }\n      {\n        this.state.error &&\n          <Callout title=\"Error!\" intent=\"danger\" className=\"upload-result\">\n            {this.state.errorMessage\n              ? this.state.errorMessage\n              : 'Some error occurred while uploading your file(s)'\n            }\n          </Callout>\n      }\n      <Upload {...uploaderProps} ref=\"inner\">\n        <Callout title={this.state.loadingIndicator ? \"Uploading...\" : \"Upload Form\"}\n          className={`upload-area ${this.state.loadingIndicator && 'loading-upload-area'}`}\n        >\n          <div className=\"pt-10\">\n            {this.state.loadingIndicator\n              ? <Icon icon=\"refresh\" className=\"spinning\" iconSize={60} title=\"Uploading...\"/>\n              : <p>\n                  Drag and drop here your XSL or XSLX files to upload to OpenMapKit Server.\n                </p>\n            }\n          </div>\n        </Callout>\n      </Upload>\n    </div>);\n  }\n}\n\nconst mapStateToProps = state => ({userDetails: state.auth.userDetails});\n\nUploadForm = connect(mapStateToProps)(UploadForm);\nexport {\n  UploadForm\n};\n","import React from 'react';\nimport {connect} from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport Upload from 'rc-upload';\nimport { Callout, Button, Icon } from '@blueprintjs/core';\nimport { Row, Col } from 'react-bootstrap';\n\nimport { cancelablePromise } from '../../utils/promise';\nimport { deploymentList } from '../../network/deployments';\n\n\nclass UploadDeployment extends React.Component {\n  getDeploymentsPromise;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      success: false,\n      error: false,\n      files: [],\n      loadingIndicator: false,\n      errorMessage: ''\n    }\n    this.authBase64 = null;\n    if (this.props.userDetails && this.props.userDetails.hasOwnProperty('username') && this.props.userDetails.username !== null) {\n      this.authBase64 = new Buffer(\n        `${this.props.userDetails.username}:${this.props.userDetails.password}`\n      ).toString('base64');\n    }\n  }\n\n  componentWillUnmount() {\n    this.getDeployments && this.getDeploymentsPromise.cancel();\n  }\n\n  componentDidMount() {\n    this.getDeployments();\n  }\n\n  getDeployments = () => {\n    this.getDeploymentsPromise = cancelablePromise(\n      deploymentList()\n    );\n    this.getDeploymentsPromise.promise\n      .then(data => this.setState(\n        {files: data.filter(i => i.name === this.props.deployment)[0].files})\n      ).catch(e => console.log(e));\n  }\n\n  bytesToSize = bytes => {\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n    if (!bytes) return '0 Byte';\n    var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));\n    return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];\n  };\n\n  render() {\n    const uploaderProps = {\n      action: `/omk/odk/deployments/${this.props.deployment}`,\n      headers: {\n        Authorization: `Basic ${this.authBase64}`\n      },\n      multiple: true,\n      beforeUpload(file) {\n        console.log('beforeUpload', file.name);\n      },\n      onStart: (file) => {\n        this.setState({loadingIndicator: true, error: false, success: false});\n        console.log('onStart', file.name);\n      },\n      onSuccess: (file) => {\n        this.setState({loadingIndicator: false, error: false, success: true});\n        this.getDeployments();\n        console.log('onSuccess', file);\n      },\n      onProgress(step, file) {\n        console.log('onProgress', Math.round(step.percent), file.name);\n      },\n      onError: (err, response) => {\n        this.setState({\n          loadingIndicator: false,\n          error: true,\n          success: false,\n          errorMessage: response.msg\n        });\n      }\n    };\n\n    return (\n      <div className=\"container mt-10 mb-20\">\n        {\n          this.state.success &&\n          <Callout title=\"Success!\" intent=\"success\" className=\"upload-result\">\n            Your file(s) has been successfully uploaded and are already available on the deployments\n          </Callout>\n        }\n        {\n          this.state.error &&\n          <Callout title=\"Error!\" intent=\"danger\" className=\"upload-result\">\n            {this.state.errorMessage\n              ? this.state.errorMessage\n              : 'Some error occurred while uploading your file(s)'\n            }\n          </Callout>\n        }\n        <div className=\"deployments mt-20\">\n          <h3>Deployment - <i>{this.props.deployment}</i></h3>\n          <hr />\n          <Row className=\"ml-0 mr-0 mt-20 pt-10 pb-10 light-gray-5\">\n            <h4>Current files</h4>\n            <Col xs={12} md={4} className=\"pt-input-group\">\n              <p><b>.geojson</b></p>\n              {(this.state.files && this.state.files.geojson) &&\n                this.state.files.geojson.map(\n                  file => <p>\n                    <a href={file.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                      {file.name}\n                    </a> <i>({this.bytesToSize(file.size)})</i>\n                  </p>\n                )\n              }\n            </Col>\n            <Col xs={12} md={4} className=\"pt-input-group\">\n              <p><b>.mbtiles</b></p>\n              {(this.state.files && this.state.files.mbtiles) &&\n                this.state.files.mbtiles.map(\n                  file => <p><a href={file.url}>{file.name}</a> <i>({this.bytesToSize(file.size)})</i></p>)\n              }\n            </Col>\n            <Col xs={12} md={4} className=\"pt-input-group\">\n              <p><b>.osm</b></p>\n              {(this.state.files && this.state.files.osm) &&\n                this.state.files.osm.map(\n                  file => <p>\n                    <a href={file.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                      {file.name}\n                    </a> <i>({this.bytesToSize(file.size)})</i>\n                  </p>\n                )\n              }\n            </Col>\n          </Row>\n          <hr />\n          <Upload {...uploaderProps} ref=\"inner\">\n            <Callout title={this.state.loadingIndicator ? \"Uploading...\" : \"Upload Form\"}\n              className={`upload-area ${this.state.loadingIndicator && 'loading-upload-area'}`}\n            >\n              <div className=\"pt-10\">\n                {this.state.loadingIndicator\n                  ? <Icon icon=\"refresh\" className=\"spinning\" iconSize={60} title=\"Uploading...\"/>\n                  : <p>\n                      Drag and drop here new deployment files.<br />\n                      Accepted formats: <code>.geojson</code>, <code>.mbtiles</code>, <code>.osm</code>\n                    </p>\n                }\n              </div>\n            </Callout>\n          </Upload>\n          <Link to=\"/deployments\">\n            <Button className=\"pt-button pt-intent-warning mt-10\">\n              <span className=\"pt-icon-standard pt-icon-arrow-left pt-align-left\"></span>\n              Select another folder\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n}\n\nUploadDeployment = connect(\n  (state, props) => ({\n    userDetails: state.auth.userDetails,\n    deployment: props.match.params.deployment\n  })\n)(UploadDeployment);\n\nexport {\n  UploadDeployment\n};\n","import React from 'react';\nimport {connect} from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { Button } from '@blueprintjs/core';\nimport { ListGroup, ListGroupItem, Grid, Row, Col } from 'react-bootstrap';\n\nimport { cancelablePromise } from '../../utils/promise';\nimport { deploymentList, createDeploymentFolder } from '../../network/deployments';\n\n\nclass SelectCreateDeployment extends React.Component {\n  getDeploymentsPromise;\n  createDeploymentPromise;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      deployments: [],\n      selectedDeployment: '',\n      newDeploymentName: '',\n      folderNameAlreadyExists: false,\n      validFolderName: false\n    }\n    this.authBase64 = null;\n    if (this.props.userDetails && this.props.userDetails.hasOwnProperty('username') && this.props.userDetails.username !== null) {\n      this.authBase64 = new Buffer(\n        `${this.props.userDetails.username}:${this.props.userDetails.password}`\n      ).toString('base64');\n    }\n  }\n\n  componentWillUnmount() {\n    this.getDeployments && this.getDeploymentsPromise.cancel();\n  }\n\n  componentDidMount() {\n    this.getDeployments();\n  }\n\n  getDeployments = () => {\n    this.getDeploymentsPromise = cancelablePromise(\n      deploymentList()\n    );\n    this.getDeploymentsPromise.promise\n      .then(data => this.setState({deployments: data}))\n      .catch(e => console.log(e));\n  }\n\n  selectDeployment = name => {\n    this.setState({\n      selectedDeployment: name\n    });\n  }\n  unselectDeployment = () => {\n    this.getDeployments();\n    this.setState({\n      selectedDeployment: ''\n    });\n  }\n  newFolderNameValue = e => {\n    this.setState({\n      'newDeploymentName': e.target.value,\n      'folderNameAlreadyExists': e.target.value &&\n        this.state.deployments.map(i => i.name).includes(e.target.value),\n      'validFolderName': !/[^a-zA-Z0-9\\-\\/]/.test( e.target.value )\n    });\n  }\n  createDeploymentFolder = () => {\n    this.createDeploymentPromise = cancelablePromise(\n      createDeploymentFolder(\n        this.state.newDeploymentName,\n        this.props.userDetails.username,\n        this.props.userDetails.password\n      )\n    );\n    this.createDeploymentPromise.promise\n      .then(data => {\n        this.setState({newDeploymentName: ''});\n        this.getDeployments();\n      }).catch(e => console.log(e));\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <div className=\"deployments mt-20 mb-20\">\n          <h2>Deployments</h2>\n          <p> Select a deployment folder to upload files to:</p>\n          <Grid className=\"deployments-list\">\n            <Row>\n              <Col xs={12} md={6} mdOffset={3}>\n                {this.state.deployments.length\n                  ? <ListGroup>\n                      {this.state.deployments.map(\n                        (deployment, key) =>\n                        <ListGroupItem key={key}>\n                          <div>\n                            <Link to={`/deployments/${deployment.name}`}>\n                              <h3 className=\"display-inline\">\n                                { deployment.name }\n                              </h3>\n                            </Link>\n                          </div>\n                        </ListGroupItem>\n                      )}\n                    </ListGroup>\n                  : <span>No deployments were found.</span>\n                }\n              </Col>\n            </Row>\n          </Grid>\n          <div className=\"mb-10\">\n            <p>Or create a new deployment folder:</p>\n            <input type=\"text\" dir=\"auto\" placeholder=\"New folder name\"\n              value={this.state.newDeploymentName}\n              className={`pt-input mb-10 ${this.state.folderNameAlreadyExists && 'pt-intent-danger'}`}\n              onChange={e => this.newFolderNameValue(e)}\n              />\n            {this.state.folderNameAlreadyExists &&\n              <p className=\"deployment-alert\">\n                There is already a deployment folder with this name.\n              </p>\n            }\n            {(this.state.newDeploymentName && !this.state.validFolderName) &&\n              <p className=\"deployment-alert\">\n                Please don't use spaces or special characters on the folder name.\n              </p>\n            }\n            {(this.state.newDeploymentName && !this.state.folderNameAlreadyExists &&\n                this.state.validFolderName\n              ) &&\n              <p>\n                <Button className=\"pt-button pt-intent-success\"\n                  onClick={e => this.createDeploymentFolder()}\n                  >\n                  Create folder\n                  <span className=\"pt-icon-standard pt-icon-arrow-right pt-align-right\"></span>\n                </Button>\n              </p>\n            }\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({userDetails: state.auth.userDetails});\n\nSelectCreateDeployment = connect(mapStateToProps)(SelectCreateDeployment);\n\nexport {\n  SelectCreateDeployment\n};\n","// @flow\n\n// Transparent wrapper over Window.localStorage\n// Adheres to the Web Storage API:\n// https://developer.mozilla.org/en-US/docs/Web/API/Storage\n\n/**\n * Wraps localStorage.getItem in a try/catch. Return null\n * if the key does not exist or localStorage fails.\n */\nfunction getItem(key: string): ?string {\n  try {\n    return localStorage.getItem(key) || null;\n  } catch (err) {\n    console.warn('Could not read from localStorage.');\n    return null;\n  }\n}\n\n/**\n * Wraps localStorage.setItem in a try/catch.\n */\nfunction setItem(key: string, value: string): void {\n  try {\n    localStorage.setItem(key, value);\n  } catch (err) {\n    console.warn('Could not write to localStorage.');\n  }\n}\n\n/**\n * Wraps localStorage.removeItem in a try/catch.\n */\nfunction removeItem(key: string): void {\n  try {\n    localStorage.removeItem(key);\n  } catch (err) {\n    console.warn('Could not delete from localStorage.');\n  }\n}\n\nexport { getItem, setItem, removeItem };\n","import React from 'react';\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\n\nimport {\n  Navbar, NavbarGroup, NavbarHeading, Button, Popover, Menu, MenuItem, Position\n} from \"@blueprintjs/core\";\n\nimport { logout } from '../store/actions/auth';\nimport { authStatus } from '../network/auth';\nimport { cancelablePromise } from '../utils/promise';\nimport logo from '../icon.png'\n\n\nclass Header extends React.Component {\n  getAuthStatusPromise;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      authEnabled: true\n    }\n  }\n\n  componentDidMount() {\n    if (!(this.props.userDetails &&\n        this.props.userDetails.username != null)) {\n          this.getAuthStatus();\n        }\n  }\n  getAuthStatus = () => {\n    this.getAuthStatusPromise = cancelablePromise(\n      authStatus()\n    );\n    this.getAuthStatusPromise.promise.then(\n      r => {\n        this.setState({ authEnabled: r.auth_enabled });\n      }\n    ).catch(e => console.log(e));\n  }\n  isAuthenticated(){\n    return this.props.userDetails &&\n      this.props.userDetails.username != null;\n  }\n  isAdmin() {\n    return (this.props.userDetails && this.props.userDetails.role === 'admin') ||\n      !this.state.authEnabled;\n  }\n  renderAuthSubMenu() {\n    if (this.state.authEnabled) {\n      if (this.isAuthenticated()) {\n        const menu = <Menu>\n          <MenuItem className=\"pt-minimal\" icon=\"log-out\" label=\"Logout\"\n            onClick={this.props.doLogout}\n            />\n        </Menu>;\n        return (\n          <Popover content={menu} position={Position.BOTTOM} className=\"pt-intent-default\">\n            <Button icon=\"user\" text={this.props.userDetails.username} />\n          </Popover>\n        );\n      } else {\n        return <Link to=\"/login\">\n          <Button className=\"pt-minimal\" icon=\"user\">\n            Log in\n          </Button>\n        </Link>\n      }\n    }\n  }\n  render() {\n    return(\n      <Navbar className=\"default-green-bg pt-dark\" fixedToTop={true} >\n        <NavbarGroup>\n            <img className=\"pt-icon main-logo pt-align-left\" src={logo} alt=\"omk logo\" />\n            <NavbarHeading>\n              <Link to=\"/\"><h3>OpenMapKit Server</h3></Link>\n            </NavbarHeading>\n        </NavbarGroup>\n        <NavbarGroup align=\"right\">\n            <Link to=\"/\">\n              <Button className=\"pt-minimal pt-white\" icon=\"home\">\n                Home\n              </Button>\n            </Link>\n            { this.isAdmin() &&\n              <Link to=\"/deployments\">\n                <Button className=\"pt-minimal pt-white\" icon=\"cloud-upload\">\n                  Deployments\n                </Button>\n              </Link>\n            }\n            { this.isAdmin() &&\n              <Link to=\"/upload-form\">\n                <Button className=\"pt-minimal pt-white\" icon=\"cloud-upload\">\n                  Upload Form\n                </Button>\n              </Link>\n            }\n            { this.isAdmin() &&\n              <Link to=\"/archived-forms\">\n                <Button className=\"pt-minimal pt-white\" icon=\"folder-close\">\n                  Archived Forms\n                </Button>\n              </Link>\n            }\n            { this.renderAuthSubMenu() }\n        </NavbarGroup>\n      </Navbar>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  userDetails: state.auth.userDetails\n});\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    doLogout: () => dispatch(logout())\n  };\n};\n\nHeader = connect(mapStateToProps, mapDispatchToProps)(Header);\n\nexport { Header };\n","import React from 'react';\nimport { Link } from \"react-router-dom\";\nimport { Map } from 'immutable';\nimport { AnchorButton, Button, ButtonGroup, Card, Elevation } from '@blueprintjs/core';\nimport { Grid, Row, Col } from 'react-bootstrap';\n\nimport { formList } from '../../network/formList';\nimport { cancelablePromise } from '../../utils/promise';\nimport { withFetchDataSilent } from '../fetch_data_enhancer';\n\n\ntype propsType = {\n  data: Map<string, any>\n};\n\nclass FormList extends React.Component<any, propsType, any> {\n\n  renderCol(form) {\n    return(\n      <Card interactive={true} elevation={Elevation.TWO}>\n          <h5 className=\"card-title\">{ form.get('name') }</h5>\n        <div className=\"text-left form-info\">\n          <p>Number of Submissions: { form.get('totalSubmissions') }</p>\n          <p>Form ID: <code>{ form.get('formID') }</code></p>\n          <ButtonGroup fill={true} vertical={true} large={false}>\n            <Link to={`/submissions/${form.get('formID')}`}>\n              <Button icon=\"list\">\n                View submissions\n              </Button>\n            </Link>\n            <AnchorButton icon=\"th\" download href={`/omk/data/forms/${form.get('formID')}.xlsx`}>\n              XSLX Form\n            </AnchorButton>\n            <AnchorButton icon=\"code\" download href={`/omk/data/forms/${form.get('formID')}.xml`}>\n              XForm XML\n            </AnchorButton>\n          </ButtonGroup>\n        </div>\n      </Card>\n    );\n  }\n\n  renderRow(data, row) {\n    return data.slice(\n      row*4, (row+1)*4\n    ).map(\n      (form, i) =>\n        <Col key={i} md={3} xs={12} className=\"forms-col\">\n          {this.renderCol(form)}\n        </Col>\n    );\n  }\n  render() {\n    let data = [];\n    let size = 0;\n    try {\n      data = this.props.data.get('data').get('xforms').get('xform');\n      size = data.size;\n    } catch (e) {\n       if (e instanceof TypeError) {}\n    }\n    let rows = Math.floor(size / 4);\n    return(\n      <Grid className=\"forms-grid\">\n        {[...Array(rows + 1).keys()].map(\n          i => <Row key={i} className=\"forms-row\">{this.renderRow(data, i)}</Row>\n        )}\n      </Grid>\n    );\n  }\n}\n\n\nFormList = withFetchDataSilent(\n  (props: propsType) => ({\n    data: cancelablePromise(formList())\n  }),\n  (nextProps: propsType, props: propsType) => true,\n  FormList\n);\n\nexport { FormList };\n","// @flow\nimport React from 'react';\nimport { Map, fromJS } from 'immutable';\nimport debounce from 'lodash.debounce';\n\n\nfunction getDisplayName(WrappedComponent: Object): string {\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n\ntype stateType = {\n  data: Map<string, *>\n};\n\n/**\n * @desc If any network request fails it silents it\n * It also sets state on first come first serve basis.\n * @param  onUpdate - decides whether to do the network calls on not\n */\nexport function withFetchDataSilent<P: {}, S: {}>(\n  dataToFetch: (props: P) => Object,\n  onUpdate: (P, P) => boolean,\n  WrappedComponent: Class<React.PureComponent<*, P, S>>\n): Class<React.PureComponent<void, P, stateType>> {\n  return class FetchDataEnhancer extends React.PureComponent<\n    void,\n    P,\n    stateType\n  > {\n    static displayName = `HOCFetchData${getDisplayName(WrappedComponent)}`;\n    state = {\n      data: Map()\n    };\n    fetchedData: Object;\n    initFetching: (props: P) => void;\n    constructor(props) {\n      super(props);\n      this.initFetching = debounce(this._initFetching, 500);\n    }\n    componentDidMount() {\n      this.initFetching(this.props);\n    }\n    componentWillReceiveProps(nextProps: P) {\n      if (onUpdate(nextProps, this.props)) {\n        this.initFetching(nextProps);\n      }\n    }\n    _initFetching = (props: P) => {\n      this.fetchedData = dataToFetch(props);\n      // iterate through all of cancelable promises, one for each api request\n      Object.keys(this.fetchedData).forEach(k => {\n        var prom = this.fetchedData[k];\n        prom.promise\n          .then(x => {\n            let data = this.state.data;\n            data = data.set(k, fromJS(x));\n            this.setState({ data });\n          })\n          .catch(e => console.error(e));\n      });\n    };\n    reloadData = () => {\n      this.initFetching(this.props);\n    };\n    componentWillUnmount() {\n      this.fetchedData &&\n        Object.keys(this.fetchedData).forEach(k => {\n          this.fetchedData[k] && this.fetchedData[k].cancel();\n        });\n    }\n    render() {\n      return (\n        <WrappedComponent\n          {...this.props}\n          data={this.state.data}\n          reloadData={this.reloadData}\n        />\n      );\n    }\n  };\n}\n","import React from 'react';\nimport { connect } from \"react-redux\";\nimport { Button } from '@blueprintjs/core';\nimport { ListGroup, ListGroupItem, Grid, Row, Col } from 'react-bootstrap';\n\nimport { cancelablePromise } from '../../utils/promise';\nimport { archivedForms, restoreForm } from '../../network/formManagement';\n\n\nclass Form extends React.Component {\n  restoreFormPromise;\n\n  state = {\n    visible: true\n  }\n\n  componentWillUnmount() {\n    this.restoreFormPromise && this.restoreFormPromise.cancel();\n  }\n\n  restoreForm = (event) => {\n    this.restoreFormPromise = cancelablePromise(\n      restoreForm(\n        this.props.formName,\n        this.props.userDetails.username,\n        this.props.userDetails.password\n      )\n    );\n    this.restoreFormPromise.promise\n      .then(\n        data => {\n          this.setState({visible: false})\n        }\n      ).catch(e => console.log(e));\n  }\n\n  render() {\n    return(\n      <ListGroupItem>\n        {this.state.visible\n          ? <div>\n              <h3 className=\"display-inline\">{ this.props.formName }</h3>\n              <Button className=\"display-inline restore-btn\" icon=\"refresh\"\n                intent=\"warning\" text=\"Restore\" onClick={this.restoreForm}\n              />\n            </div>\n          : <div>\n              <h3>Form Restored</h3>\n            </div>\n        }\n      </ListGroupItem>\n    );\n  }\n}\n\n\nclass ArchivedForms extends React.Component {\n  getArchivedFormsPromise;\n\n  state = {\n    forms: []\n  }\n\n  componentWillUnmount() {\n      this.getArchivedFormsPromise && this.getArchivedFormsPromise.cancel();\n  }\n\n  componentDidMount() {\n    this.getArchivedForms();\n  }\n\n  getArchivedForms = () => {\n    this.getArchivedFormsPromise = cancelablePromise(\n      archivedForms(this.props.userDetails.username, this.props.userDetails.password)\n    );\n    this.getArchivedFormsPromise.promise\n      .then(data => this.setState({forms: data.forms}))\n      .catch(e => console.log(e));\n  }\n\n  render() {\n    return(\n      <div className=\"archived-forms\">\n        <h2>Archived Forms</h2>\n        <Grid className=\"archived-form-list\">\n          <Row>\n            <Col xs={12} md={6} mdOffset={3}>\n              {this.state.forms.length\n                ? <ListGroup>\n                    {this.state.forms.map(\n                      (form, key) =>\n                      <Form key={key} userDetails={this.props.userDetails} formName={form} />\n                    )}\n                  </ListGroup>\n                : <span>No archived forms were found.</span>\n              }\n            </Col>\n          </Row>\n        </Grid>\n      </div>\n    );\n  }\n}\n\nArchivedForms = connect(\n  (state, props) => ({\n    userDetails: state.auth.userDetails,\n  })\n)(ArchivedForms);\n\nexport { ArchivedForms };\n","import React, { Component } from 'react';\nimport { Route } from \"react-router-dom\";\n\nimport { Header } from './components/header';\nimport { SubmissionList } from './components/submissionList';\nimport { LoginPanel } from './components/loginPanel';\nimport { FormList } from './components/forms/formList';\nimport { UploadForm } from './components/forms/uploadForm';\nimport { ArchivedForms } from './components/forms/archivedList';\nimport { UploadDeployment } from './components/deployments/upload';\nimport { SelectCreateDeployment } from './components/deployments/selectCreate';\nimport './App.css';\n\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <Header />\n        <div className=\"top-50\">\n          <Route exact path=\"/\" component={FormList} />\n          <Route exact path=\"/login\" component={LoginPanel} />\n          <Route exact path=\"/upload-form\" component={UploadForm} />\n          <Route exact path=\"/archived-forms\" component={ArchivedForms} />\n          <Route exact path=\"/deployments\" component={SelectCreateDeployment} />\n          <Route exact path=\"/deployments/:deployment\" component={UploadDeployment} />\n          <Route exact path=\"/submissions/:formId\" component={SubmissionList} />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { types } from '../actions/auth';\n\nconst initialState = {\n  userDetails: new Map()\n};\n\nexport function authReducer(state = initialState, action) {\n  switch (action.type) {\n    case types.SET_USER: {\n      return {'userDetails': action.userDetails};\n    }\n    default:\n      return state;\n  }\n}\n","import { types } from '../actions/displayPreferences';\n\nconst initialState = {\n  pageSize: 200,\n  dataView: 'map'\n};\n\nexport function preferencesReducer(state = initialState, action) {\n  switch (action.type) {\n    case types.SET_PAGE_SIZE: {\n      return {\n        'pageSize': action.pageSize,\n        'dataView': state.dataView\n      };\n    }\n    case types.SET_DATA_VIEW: {\n      return {\n        'pageSize': state.pageSize,\n        'dataView': action.dataView\n      };\n    }\n    default:\n      return state;\n  }\n}\n","import { combineReducers } from \"redux\";\nimport { routerReducer } from \"react-router-redux\";\n\nimport { authReducer } from './auth';\nimport { preferencesReducer } from './displayPreferences';\n\n\nexport default combineReducers({\n  auth: authReducer,\n  preferences: preferencesReducer,\n  router: routerReducer\n});\n","import { applyMiddleware, createStore, compose } from \"redux\";\nimport createHistory from \"history/createBrowserHistory\";\nimport { routerMiddleware } from \"react-router-redux\";\nimport thunk from \"redux-thunk\";\n\nimport * as safeStorage from '../utils/safe_storage';\nimport reducers from \"./reducers\";\n\n\nconst persistedState = {\n  auth: {userDetails: {\n    id: safeStorage.getItem('username'),\n    username: safeStorage.getItem('username'),\n    password: safeStorage.getItem('password'),\n    role: safeStorage.getItem('role'),\n  }},\n  preferences: {\n    dataView: safeStorage.getItem('dataView'),\n    pageSize: safeStorage.getItem('pageSize')\n  }\n};\n\nexport const history = createHistory()\nconst middleware = [thunk, routerMiddleware(history)];\nconst enhancers = [];\n\nif (process.env.NODE_ENV === 'development') {\n  const devToolsExtension = window.devToolsExtension;\n\n  if (typeof devToolsExtension === 'function') {\n    enhancers.push(devToolsExtension());\n  }\n}\n\nconst composedEnhancers = compose(applyMiddleware(...middleware), ...enhancers);\n\nconst store = createStore(\n  reducers,\n  persistedState,\n  composedEnhancers\n);\n\nexport { store };\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Router } from \"react-router-dom\";\nimport { Provider } from \"react-redux\";\nimport createHistory from \"history/createHashHistory\";\n\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"bootstrap/dist/css/bootstrap-theme.css\";\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport '@blueprintjs/table/lib/css/table.css';\nimport '@blueprintjs/icons/lib/css/blueprint-icons.css';\nimport '@blueprintjs/datetime/lib/css/blueprint-datetime.css';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\nimport { store } from './store';\n\nconst history = createHistory()\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router history={history}>\n      <App />\n    </Router>\n  </Provider>,\n  document.getElementById('root'));\nregisterServiceWorker();\n","// @flow\n// export type cancelablePromiseType = { promise: Promise<*>, cancel: () => any };\nexport function cancelablePromise(promise: Promise<*>) {\n  let hasCanceled_ = false;\n\n  const wrappedPromise = new Promise((resolve, reject) => {\n    promise\n      .then(val => (hasCanceled_ ? reject({ isCanceled: true }) : resolve(val)))\n      .catch(\n        error => (hasCanceled_ ? reject({ isCanceled: true }) : reject(error))\n      );\n  });\n\n  return {\n    promise: wrappedPromise,\n    cancel() {\n      hasCanceled_ = true;\n    }\n  };\n}\nexport function handleErrors(response) {\n  if (!response.ok) {\n    throw Error(response.statusText);\n  }\n  return response;\n}\n\nexport function cancelableFetchJSON(url: string) {\n  return cancelablePromise(\n    fetch(url)\n      .then(handleErrors)\n      .then(res => {\n        return res.json();\n      })\n  );\n}\n\nexport function delayPromise(\n  interval: number\n): { promise: Promise<*>, cancel: () => any } {\n  return cancelablePromise(new Promise(res => setTimeout(res, interval)));\n}\n","import * as safeStorage from '../../utils/safe_storage';\n\nexport const types = {\n  SET_USER: 'SET_USER',\n  CLEAR_USER: 'CLEAR_USER'\n};\n\n\nexport function updateUserDetails(userDetails) {\n  return {\n    type: types.SET_USER,\n    userDetails: userDetails\n  };\n}\nexport function clearUserDetails() {\n  return {\n    type: types.SET_USER,\n    userDetails: {}\n  };\n}\n\nexport const logout = () => dispatch => {\n  safeStorage.removeItem('id');\n  safeStorage.removeItem('username');\n  safeStorage.removeItem('password');\n  safeStorage.removeItem('role');\n  dispatch(clearUserDetails());\n\n};\n\nexport const login = (username, password) => dispatch => {\n  fetch(`/omk/login/`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      username: username,\n      password: password\n    })\n  })\n  .then(res => {\n    return res.json();\n  })\n  .then(userDetails => {\n    safeStorage.setItem('id', userDetails.user.id);\n    safeStorage.setItem('username', userDetails.user.username);\n    safeStorage.setItem('password', userDetails.user.password);\n    safeStorage.setItem('role', userDetails.user.role);\n    dispatch(updateUserDetails(userDetails.user));\n  })\n  .catch(err => console.warn(err));\n};\n","import { handleErrors } from '../utils/promise';\n\n\nexport function archivedForms(username, password): Promise<*> {\n  const authBase64 = new Buffer(username + ':' + password).toString('base64');\n  return fetch('/omk/odk/archived-forms', {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Authorization': `Basic ${authBase64}`\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function restoreForm(formName, username, password): Promise<*> {\n  const authBase64 = new Buffer(username + ':' + password).toString('base64');\n  const url = `/omk/odk/forms/${formName}/restore`\n  return fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Authorization': `Basic ${authBase64}`\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function archiveForm(formName, username, password): Promise<*> {\n  const authBase64 = new Buffer(username + ':' + password).toString('base64');\n  const url = `/omk/odk/forms/${formName}/archive`\n  return fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Authorization': `Basic ${authBase64}`\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function deleteForm(formName, username, password): Promise<*> {\n  const authBase64 = new Buffer(username + ':' + password).toString('base64');\n  const url = `/omk/odk/forms/${formName}/delete`\n  return fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Authorization': `Basic ${authBase64}`\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import * as safeStorage from '../../utils/safe_storage';\n\nexport const types = {\n  SET_PAGE_SIZE: 'SET_PAGE_SIZE',\n  SET_DATA_VIEW: 'SET_DATA_VIEW'\n};\n\n\nexport function updatePageSize(pageSize) {\n  return {\n    type: types.SET_PAGE_SIZE,\n    pageSize: pageSize\n  };\n}\n\nexport function updateDataView(dataView) {\n  return {\n    type: types.SET_DATA_VIEW,\n    dataView: dataView\n  };\n}\n\nexport const setDataView = (dataView) => dispatch => {\n  safeStorage.setItem('dataView', dataView);\n  dispatch(updateDataView(dataView));\n};\n\nexport const setPageSize = (pageSize) => dispatch => {\n  safeStorage.setItem('pageSize', pageSize);\n  dispatch(updatePageSize(pageSize));\n};\n","import { handleErrors } from '../utils/promise';\n\n\nexport function deploymentList(deployment): Promise<*> {\n  let url = `/omk/deployments/`\n  return fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function createDeploymentFolder(deployment, username, password): Promise<*> {\n  const authBase64 = new Buffer(username + ':' + password).toString('base64');\n  let url = `/omk/odk/deployments/`;\n  return fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Authorization': `Basic ${authBase64}`\n    },\n    body: JSON.stringify({\n      name: deployment\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import { handleErrors } from '../utils/promise';\n\nexport function authStatus(): Promise<*> {\n  return fetch(`/omk/auth-status/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function login(username: string, password: string): Promise<*> {\n  return fetch(`/omk/login`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import { handleErrors } from '../utils/promise';\n\n\nexport function getSubmissions(formId, username, password): Promise<*> {\n  const authBase64 = new Buffer(username + ':' + password).toString('base64');\n  return fetch(`/omk/odk/submissions/${formId}.json?offset=0&limit=5000`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Authorization': `Basic ${authBase64}`\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function getSubmissionsGeojson(formId, username, password, filterParams): Promise<*> {\n  const authBase64 = new Buffer(username + ':' + password).toString('base64');\n  let url = `/omk/odk/submissions/${formId}.geojson?${filterParams}`;\n  return fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Requested-With': 'XMLHttpRequest',\n      'Authorization': `Basic ${authBase64}`\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import { handleErrors } from '../utils/promise';\n\nexport function formList(formId): Promise<*> {\n  let url = `/formList?json=true`\n  if (formId) {\n    url = `/formList?json=true&formid=${formId}`\n  }\n  return fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router'\nimport { Button } from \"@blueprintjs/core\";\n\nimport { login } from '../store/actions/auth';\n\n\nclass LoginPanel extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: props.username ? props.username : '',\n      password: '',\n      triedToLogin: false\n    };\n    this.onSubmit = this.onSubmit.bind(this);\n    this.changeUsername = this.changeUsername.bind(this);\n    this.changePassword = this.changePassword.bind(this);\n  }\n  changeUsername(event) {\n    this.setState({username: event.target.value});\n  }\n  changePassword(event) {\n    this.setState({password: event.target.value});\n  }\n\n  onSubmit = event => {\n    event.preventDefault();\n    this.props.authenticateUser(this.state.username, this.state.password);\n    this.setState({triedToLogin: true});\n  }\n\n  render() {\n    return(\n      <div className=\"pt-input-group login center-block\">\n        {!this.props.username\n          ? <div>\n              <form onSubmit={this.onSubmit}>\n                <h2>Sign in</h2>\n                {this.state.triedToLogin &&\n                  <div className=\"pt-callout pt-intent-danger\">\n                    <h4 className=\"pt-callout-title\">Login failed</h4>\n                    Verify your username or password.\n                  </div>\n                }\n                <input type=\"text\" className=\"pt-input mt-10\" value={this.state.username}\n                  onChange={this.changeUsername} placeholder=\"Username\" />\n                <input type=\"password\" className=\"pt-input mt-10\" value={this.state.password}\n                  onChange={this.changePassword} placeholder=\"Enter your password...\" />\n                <Button type=\"submit\" className=\"pt-large\" intent=\"success\" icon=\"log-in\" text=\"Sign In\" />\n              </form>\n            </div>\n          : <Redirect to='/' />\n      }\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    username: state.auth.userDetails ? state.auth.userDetails.username : ''\n  };\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    authenticateUser: (username, password) => dispatch(login(username, password))\n  };\n};\n\nLoginPanel = connect(mapStateToProps, mapDispatchToProps)(LoginPanel);\n\nexport { LoginPanel };\n"],"sourceRoot":""}